# KEEP EVERYTHING BEFORE THIS SAME AS YOUR CURRENT FILE
# REPLACE ONLY THE PACKER VALIDATE SECTION WITH THIS BLOCK:

      - name: Packer validate
        run: |
          mkdir -p ci-logs

          echo "Searching for packer template files..."

          FILES=$(find . -type f \( -name "*.pkr.hcl" -o -name "*.json" \))

          if [ -z "$FILES" ]; then
            echo "No packer templates found. Skipping validation."
            exit 0
          fi

          echo "Found templates:"
          echo "$FILES"

          echo "$FILES" | while read -r f; do
            echo "Validating: $f"
            packer validate "$f"
          done 2>&1 | tee ci-logs/packer-validate.log

